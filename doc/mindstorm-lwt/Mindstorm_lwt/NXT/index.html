<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>NXT (mindstorm-lwt.Mindstorm_lwt.NXT)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../index.html">mindstorm-lwt</a> &#x00BB; <a href="../index.html">Mindstorm_lwt</a> &#x00BB; NXT</nav><header class="odoc-preamble"><h1>Module <code><span>Mindstorm_lwt.NXT</span></code></h1></header><nav class="odoc-toc"><ul><li><a href="#exception-for-errors">Exception for errors</a></li><li><a href="#direct-commands">Direct commands</a></li><li><a href="#system-commands">System commands</a><ul><li><a href="#files">Files</a></li><li><a href="#brick-information">Brick information</a></li><li><a href="#polling">Polling</a></li></ul></li></ul></nav><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-usb" class="anchored"><a href="#type-usb" class="anchor"></a><code><span><span class="keyword">type</span> usb</span></code></div><div class="spec-doc"><p>USB connection type.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-bluetooth" class="anchored"><a href="#type-bluetooth" class="anchor"></a><code><span><span class="keyword">type</span> bluetooth</span></code></div><div class="spec-doc"><p>Bluetooth connection type.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-conn" class="anchored"><a href="#type-conn" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a conn</span></span></code></div><div class="spec-doc"><p>Abstract type representing a connection to a LEGO® mindstorm brick. The type parameter indicates whether this connection is a USB or a Bluetooth one.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-connect_bluetooth" class="anchored"><a href="#val-connect_bluetooth" class="anchor"></a><code><span><span class="keyword">val</span> connect_bluetooth : <span>?check_status:bool <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><a href="#type-bluetooth">bluetooth</a> <a href="#type-conn">conn</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>connect_bluetooth bdaddr</code> connects through bluetooth to the brick with bluetooth address <code>bdaddr</code>. See the section &quot;<code>connectBluetooth</code>&quot; for more information.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">check_status</span> <p>set the default value for the <code>check_status</code> optional argument. This global default allows to easily globally activate status checking for a given connection. Checking the status ensures the command was transmitted properly but incur a cost of 60ms between two transmissions. Default: <code>false</code>.</p></li></ul><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">Unix.Unix_error</span> <p>in case of a connection problem. In particular, <code>Unix.Unix_error(Unix.EHOSTDOWN, _,_)</code> is raised if the brick is not turned on.</p></li></ul></div></div><div class="odoc-spec"><div class="spec module" id="module-USB" class="anchored"><a href="#module-USB" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="USB/index.html">USB</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Functions to choose and connect to NXT bricks connected through USB. So far, it works on Linux (users of other platforms, your help is welcome).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-close" class="anchored"><a href="#val-close" class="anchor"></a><code><span><span class="keyword">val</span> close : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>close conn</code> closes the connection <code>conn</code> to the brick.</p></div></div><h3 id="exception-for-errors"><a href="#exception-for-errors" class="anchor"></a>Exception for errors</h3><div class="odoc-spec"><div class="spec type" id="type-error" class="anchored"><a href="#type-error" class="anchor"></a><code><span><span class="keyword">type</span> error</span><span> = <a href="../../../mindstorm/Mindstorm/NXT/index.html#type-error">Mindstorm.NXT.error</a></span><span> = </span></code><table><tr id="type-error.No_more_handles" class="anchored"><td class="def variant constructor"><a href="#type-error.No_more_handles" class="anchor"></a><code><span>| </span><span><span class="constructor">No_more_handles</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>All 16 handles are in use.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.No_space" class="anchored"><td class="def variant constructor"><a href="#type-error.No_space" class="anchor"></a><code><span>| </span><span><span class="constructor">No_space</span></span></code></td></tr><tr id="type-error.No_more_files" class="anchored"><td class="def variant constructor"><a href="#type-error.No_more_files" class="anchor"></a><code><span>| </span><span><span class="constructor">No_more_files</span></span></code></td></tr><tr id="type-error.EOF_expected" class="anchored"><td class="def variant constructor"><a href="#type-error.EOF_expected" class="anchor"></a><code><span>| </span><span><span class="constructor">EOF_expected</span></span></code></td></tr><tr id="type-error.Not_a_linear_file" class="anchored"><td class="def variant constructor"><a href="#type-error.Not_a_linear_file" class="anchor"></a><code><span>| </span><span><span class="constructor">Not_a_linear_file</span></span></code></td></tr><tr id="type-error.No_linear_space" class="anchored"><td class="def variant constructor"><a href="#type-error.No_linear_space" class="anchor"></a><code><span>| </span><span><span class="constructor">No_linear_space</span></span></code></td></tr><tr id="type-error.Undefined_error" class="anchored"><td class="def variant constructor"><a href="#type-error.Undefined_error" class="anchor"></a><code><span>| </span><span><span class="constructor">Undefined_error</span></span></code></td></tr><tr id="type-error.File_is_busy" class="anchored"><td class="def variant constructor"><a href="#type-error.File_is_busy" class="anchor"></a><code><span>| </span><span><span class="constructor">File_is_busy</span></span></code></td></tr><tr id="type-error.No_write_buffers" class="anchored"><td class="def variant constructor"><a href="#type-error.No_write_buffers" class="anchor"></a><code><span>| </span><span><span class="constructor">No_write_buffers</span></span></code></td></tr><tr id="type-error.Append_not_possible" class="anchored"><td class="def variant constructor"><a href="#type-error.Append_not_possible" class="anchor"></a><code><span>| </span><span><span class="constructor">Append_not_possible</span></span></code></td></tr><tr id="type-error.File_is_full" class="anchored"><td class="def variant constructor"><a href="#type-error.File_is_full" class="anchor"></a><code><span>| </span><span><span class="constructor">File_is_full</span></span></code></td></tr><tr id="type-error.File_exists" class="anchored"><td class="def variant constructor"><a href="#type-error.File_exists" class="anchor"></a><code><span>| </span><span><span class="constructor">File_exists</span></span></code></td></tr><tr id="type-error.Module_not_found" class="anchored"><td class="def variant constructor"><a href="#type-error.Module_not_found" class="anchor"></a><code><span>| </span><span><span class="constructor">Module_not_found</span></span></code></td></tr><tr id="type-error.Out_of_boundary" class="anchored"><td class="def variant constructor"><a href="#type-error.Out_of_boundary" class="anchor"></a><code><span>| </span><span><span class="constructor">Out_of_boundary</span></span></code></td></tr><tr id="type-error.Illegal_file_name" class="anchored"><td class="def variant constructor"><a href="#type-error.Illegal_file_name" class="anchor"></a><code><span>| </span><span><span class="constructor">Illegal_file_name</span></span></code></td></tr><tr id="type-error.Pending" class="anchored"><td class="def variant constructor"><a href="#type-error.Pending" class="anchor"></a><code><span>| </span><span><span class="constructor">Pending</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Pending communication transaction in progress</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Empty_mailbox" class="anchored"><td class="def variant constructor"><a href="#type-error.Empty_mailbox" class="anchor"></a><code><span>| </span><span><span class="constructor">Empty_mailbox</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Specified mailbox queue is empty</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Failed" class="anchored"><td class="def variant constructor"><a href="#type-error.Failed" class="anchor"></a><code><span>| </span><span><span class="constructor">Failed</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Request failed (i.e. specified file not found)</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Unknown" class="anchored"><td class="def variant constructor"><a href="#type-error.Unknown" class="anchor"></a><code><span>| </span><span><span class="constructor">Unknown</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Unknown command opcode</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Insane" class="anchored"><td class="def variant constructor"><a href="#type-error.Insane" class="anchor"></a><code><span>| </span><span><span class="constructor">Insane</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Insane packet</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Out_of_range" class="anchored"><td class="def variant constructor"><a href="#type-error.Out_of_range" class="anchor"></a><code><span>| </span><span><span class="constructor">Out_of_range</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Data contains out-of-range values</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Bus_error" class="anchored"><td class="def variant constructor"><a href="#type-error.Bus_error" class="anchor"></a><code><span>| </span><span><span class="constructor">Bus_error</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Communication bus error, can indicate a device failure.</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Buffer_full" class="anchored"><td class="def variant constructor"><a href="#type-error.Buffer_full" class="anchor"></a><code><span>| </span><span><span class="constructor">Buffer_full</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>No free memory in communication buffer</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Invalid_conn" class="anchored"><td class="def variant constructor"><a href="#type-error.Invalid_conn" class="anchor"></a><code><span>| </span><span><span class="constructor">Invalid_conn</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Specified channel/connection is not valid</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Busy_conn" class="anchored"><td class="def variant constructor"><a href="#type-error.Busy_conn" class="anchor"></a><code><span>| </span><span><span class="constructor">Busy_conn</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Specified channel/connection not configured or busy</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.No_program" class="anchored"><td class="def variant constructor"><a href="#type-error.No_program" class="anchor"></a><code><span>| </span><span><span class="constructor">No_program</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>No active program</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Bad_size" class="anchored"><td class="def variant constructor"><a href="#type-error.Bad_size" class="anchor"></a><code><span>| </span><span><span class="constructor">Bad_size</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Illegal size specified</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Bad_mailbox" class="anchored"><td class="def variant constructor"><a href="#type-error.Bad_mailbox" class="anchor"></a><code><span>| </span><span><span class="constructor">Bad_mailbox</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Illegal mailbox queue ID specified</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Bad_field" class="anchored"><td class="def variant constructor"><a href="#type-error.Bad_field" class="anchor"></a><code><span>| </span><span><span class="constructor">Bad_field</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Attempted to access invalid field of a structure</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Bad_io" class="anchored"><td class="def variant constructor"><a href="#type-error.Bad_io" class="anchor"></a><code><span>| </span><span><span class="constructor">Bad_io</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Bad input or output specified</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Out_of_memory" class="anchored"><td class="def variant constructor"><a href="#type-error.Out_of_memory" class="anchor"></a><code><span>| </span><span><span class="constructor">Out_of_memory</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Insufficient memory available</p><span class="comment-delim">*)</span></td></tr><tr id="type-error.Bad_arg" class="anchored"><td class="def variant constructor"><a href="#type-error.Bad_arg" class="anchor"></a><code><span>| </span><span><span class="constructor">Bad_arg</span></span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Bad arguments</p><span class="comment-delim">*)</span></td></tr></table></div><div class="spec-doc"><p>Error codes. The codes starting with <code>Pending</code> are command error.</p></div></div><div class="odoc-spec"><div class="spec exception" id="exception-Error" class="anchored"><a href="#exception-Error" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">Error</span> <span class="keyword">of</span> <a href="#type-error">error</a></span></code></div><div class="spec-doc"><p>This exception can be raised by any of the functions below except when the optional argument <code>~check_status</code> is set to false. Note that checking for errors leads to up to approximately a 60ms latency between two commands.</p></div></div><div class="odoc-spec"><div class="spec exception" id="exception-File_not_found" class="anchored"><a href="#exception-File_not_found" class="anchor"></a><code><span><span class="keyword">exception</span> </span><span><span class="exception">File_not_found</span></span></code></div><div class="spec-doc"><p>Raised to indicate that a file is not present on the brick.</p></div></div><h3 id="direct-commands"><a href="#direct-commands" class="anchor"></a>Direct commands</h3><div class="odoc-spec"><div class="spec module" id="module-Program" class="anchored"><a href="#module-Program" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Program/index.html">Program</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Starting and stopping programs (.rxe files) on the brick.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Motor" class="anchored"><a href="#module-Motor" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Motor/index.html">Motor</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Output ports.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Sensor" class="anchored"><a href="#module-Sensor" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Sensor/index.html">Sensor</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Input ports.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Sound" class="anchored"><a href="#module-Sound" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Sound/index.html">Sound</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Play sounds (.rso files) and tones.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Message" class="anchored"><a href="#module-Message" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Message/index.html">Message</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>Read and write messages from the 10 message queues. This can be thought as advanced direct commands.</p></div></div><h3 id="system-commands"><a href="#system-commands" class="anchor"></a>System commands</h3><h4 id="files"><a href="#files" class="anchor"></a>Files</h4><div class="odoc-spec"><div class="spec type" id="type-in_channel" class="anchored"><a href="#type-in_channel" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a in_channel</span></span></code></div><div class="spec-doc"><p>Handle for reading from the brick.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-open_in" class="anchored"><a href="#val-open_in" class="anchor"></a><code><span><span class="keyword">val</span> open_in : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-in_channel">in_channel</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>open_in conn fname</code> opens the file named <code>fname</code> on the brick for reading. The channel must be closed with <a href="#val-close_in"><code>Mindstorm_lwt.NXT.close_in</code></a>. Close it as soon as possible as channels are a scarce resource.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">Invalid_argument</span> <p>if <code>fname</code> is not a ASCIIZ string with maximum 15.3 characters.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-in_channel_length" class="anchored"><a href="#val-in_channel_length" class="anchor"></a><code><span><span class="keyword">val</span> in_channel_length : <span><span><span class="type-var">'a</span> <a href="#type-in_channel">in_channel</a></span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>in_channel_length ch</code> returns the length of the channel <code>ch</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-close_in" class="anchored"><a href="#val-close_in" class="anchor"></a><code><span><span class="keyword">val</span> close_in : <span><span><span class="type-var">'a</span> <a href="#type-in_channel">in_channel</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>close_in ch</code> closes the channel <code>ch</code>. Closing an already closed channel does nothing.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-input" class="anchored"><a href="#val-input" class="anchor"></a><code><span><span class="keyword">val</span> input : <span><span><span class="type-var">'a</span> <a href="#type-in_channel">in_channel</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span class="xref-unresolved">Stdlib</span>.Bytes.t <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>input ch buf ofs len</code> reads a block of data of length <code>len</code> from the channel <code>ch</code> and write it to <code>buf</code> starting at position <code>ofs</code>.</p><ul class="at-tags"><li class="raises"><span class="at-tag">raises</span> <span class="value">End_of_file</span> <p>if there is no more data to read.</p></li></ul></div></div><div class="odoc-spec"><div class="spec type" id="type-out_channel" class="anchored"><a href="#type-out_channel" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a out_channel</span></span></code></div><div class="spec-doc"><p>Handle for writing data to the brick.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-out_flag" class="anchored"><a href="#type-out_flag" class="anchor"></a><code><span><span class="keyword">type</span> out_flag</span><span> = </span><span>[ </span></code><table><tr id="type-out_flag.File" class="anchored"><td class="def constructor"><a href="#type-out_flag.File" class="anchor"></a><code><span>| </span></code><code><span>`File <span class="keyword">of</span> int</span></code></td></tr><tr id="type-out_flag.Linear" class="anchored"><td class="def constructor"><a href="#type-out_flag.Linear" class="anchor"></a><code><span>| </span></code><code><span>`Linear <span class="keyword">of</span> int</span></code></td></tr><tr id="type-out_flag.Data" class="anchored"><td class="def constructor"><a href="#type-out_flag.Data" class="anchor"></a><code><span>| </span></code><code><span>`Data <span class="keyword">of</span> int</span></code></td></tr><tr id="type-out_flag.Append" class="anchored"><td class="def constructor"><a href="#type-out_flag.Append" class="anchor"></a><code><span>| </span></code><code><span>`Append</span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>The standard NXT firmware requires that executable files and icons are linear but all other types of files (including sound files) can be non-contiguous (i.e., fragmented).</p><ul><li><code>`File length</code>: Default file, the parameter is its <code>length</code>.</li><li><code>`Linear length</code>: Write a linear file, the parameter is its <code>length</code>.</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-open_out" class="anchored"><a href="#val-open_out" class="anchor"></a><code><span><span class="keyword">val</span> open_out : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-out_flag">out_flag</a> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-out_channel">out_channel</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>open_out conn flag fname</code> opens the file <code>fname</code> for writing. The channel must be closed with <a href="#val-close_in"><code>Mindstorm_lwt.NXT.close_in</code></a>. Close it as soon as possible as channels are a scarce resource.</p><p>If the the file exists, <code>Error File_exists</code> is raised. If the brick does not like the extension you use, <code>Error File_is_full</code> may be raised.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-close_out" class="anchored"><a href="#val-close_out" class="anchor"></a><code><span><span class="keyword">val</span> close_out : <span><span><span class="type-var">'a</span> <a href="#type-out_channel">out_channel</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>close_out ch</code> closes the channel <code>ch</code>. Closing an already closed channel does nothing.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-output" class="anchored"><a href="#val-output" class="anchor"></a><code><span><span class="keyword">val</span> output : <span><span><span class="type-var">'a</span> <a href="#type-out_channel">out_channel</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>output ch buf ofs len</code> ouputs the substring <code>buf.[ofs
      .. ofs+len-1]</code> to the channel <code>fd</code>. Returns the number of bytes actually written. If you try to write more bytes than declared when opening the file, <code>Error File_is_full</code> is raised.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-remove" class="anchored"><a href="#val-remove" class="anchor"></a><code><span><span class="keyword">val</span> remove : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>remove conn fname</code> remove the file <code>fname</code> from the brick.</p></div></div><div class="odoc-spec"><div class="spec module" id="module-Find" class="anchored"><a href="#module-Find" class="anchor"></a><code><span><span class="keyword">module</span> </span><span><a href="Find/index.html">Find</a></span><span> : <span class="keyword">sig</span> ... <span class="keyword">end</span></span></code></div><div class="spec-doc"><p>List files on the brick matching a given pattern.</p></div></div><h4 id="brick-information"><a href="#brick-information" class="anchor"></a>Brick information</h4><div class="odoc-spec"><div class="spec value" id="val-firmware_version" class="anchored"><a href="#val-firmware_version" class="anchor"></a><code><span><span class="keyword">val</span> firmware_version : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>(int * int * int * int)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>firmware_version conn</code> returns a tuple <code>(p1, p0, f1, f0)</code> where <code>p1</code> is the major version of the protocol, <code>p0</code> is the minor version of the protocol, <code>f1</code> is the major version of the firmware, <code>f0</code> is the minor version of the firmware,</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set_brick_name" class="anchored"><a href="#val-set_brick_name" class="anchor"></a><code><span><span class="keyword">val</span> set_brick_name : <span>?check_status:bool <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span>string <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>set_brick_name conn name</code> change the name to which one is connected through <code>conn</code> to <code>name</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">check_status</span> <p>whether to check the status returned by the brick (and raise <code>Error</code> accordingly). Default: see <code>Mindstorm_lwt</code>.NXT.connect_bluetooth.</p></li></ul></div></div><div class="odoc-spec"><div class="spec type" id="type-brick_info" class="anchored"><a href="#type-brick_info" class="anchor"></a><code><span><span class="keyword">type</span> brick_info</span><span> = <a href="../../../mindstorm/Mindstorm/NXT/index.html#type-brick_info">Mindstorm.NXT.brick_info</a></span><span> = </span><span>{</span></code><table><tr id="type-brick_info.brick_name" class="anchored"><td class="def record field"><a href="#type-brick_info.brick_name" class="anchor"></a><code><span>brick_name : string;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>NXT name (set with <a href="#val-set_brick_name"><code>Mindstorm_lwt.NXT.set_brick_name</code></a>)</p><span class="comment-delim">*)</span></td></tr><tr id="type-brick_info.bluetooth_addr" class="anchored"><td class="def record field"><a href="#type-brick_info.bluetooth_addr" class="anchor"></a><code><span>bluetooth_addr : string;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Bluetooth address</p><span class="comment-delim">*)</span></td></tr><tr id="type-brick_info.signal_strength" class="anchored"><td class="def record field"><a href="#type-brick_info.signal_strength" class="anchor"></a><code><span>signal_strength : int;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Bluetooth signal strength (for some reason is always 0)</p><span class="comment-delim">*)</span></td></tr><tr id="type-brick_info.free_user_flash" class="anchored"><td class="def record field"><a href="#type-brick_info.free_user_flash" class="anchor"></a><code><span>free_user_flash : int;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Free user FLASH</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-get_device_info" class="anchored"><a href="#val-get_device_info" class="anchor"></a><code><span><span class="keyword">val</span> get_device_info : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-brick_info">brick_info</a> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>get_device_info conn</code> returns some informations about the brick connected through <code>conn</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-keep_alive" class="anchored"><a href="#val-keep_alive" class="anchor"></a><code><span><span class="keyword">val</span> keep_alive : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>keep_alive conn</code> returns the current sleep time limit in milliseconds.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-battery_level" class="anchored"><a href="#val-battery_level" class="anchor"></a><code><span><span class="keyword">val</span> battery_level : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>battery_level conn</code> return the voltages in millivolts of the battery on the brick.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-delete_user_flash" class="anchored"><a href="#val-delete_user_flash" class="anchor"></a><code><span><span class="keyword">val</span> delete_user_flash : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><div class="odoc-spec"><div class="spec value" id="val-bluetooth_reset" class="anchored"><a href="#val-bluetooth_reset" class="anchor"></a><code><span><span class="keyword">val</span> bluetooth_reset : <span><span><a href="#type-usb">usb</a> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>bluetooth_reset conn</code> performs a factory reset of the brick. (The type system does will a allow this command to be transmitted via bluetooth because all bluetooth functionality is reset by this command.)</p></div></div><div class="odoc-spec"><div class="spec value" id="val-boot" class="anchored"><a href="#val-boot" class="anchor"></a><code><span><span class="keyword">val</span> boot : <span><span><a href="#type-usb">usb</a> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div></div><h4 id="polling"><a href="#polling" class="anchor"></a>Polling</h4><div class="odoc-spec"><div class="spec value" id="val-poll_length" class="anchored"><a href="#val-poll_length" class="anchor"></a><code><span><span class="keyword">val</span> poll_length : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Poll_buffer <span>| `High_speed_buffer</span> ]</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Returns the number of bytes for a command in the low-speed buffer or the high-speed buffer (0 = no command is ready).</p></div></div><div class="odoc-spec"><div class="spec value" id="val-poll_command" class="anchored"><a href="#val-poll_command" class="anchor"></a><code><span><span class="keyword">val</span> poll_command : <span><span><span class="type-var">'a</span> <a href="#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Poll_buffer <span>| `High_speed_buffer</span> ]</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <span><span>(int * string)</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p>Reads bytes from the low-speed or high-speed buffer.</p></div></div></div></body></html>