<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Ultrasonic (mindstorm-lwt.Mindstorm_lwt.NXT.Sensor.Ultrasonic)</title><link rel="stylesheet" href="../../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> – <a href="../../../../index.html">mindstorm-lwt</a> &#x00BB; <a href="../../../index.html">Mindstorm_lwt</a> &#x00BB; <a href="../../index.html">NXT</a> &#x00BB; <a href="../index.html">Sensor</a> &#x00BB; Ultrasonic</nav><header class="odoc-preamble"><h1>Module <code><span>Sensor.Ultrasonic</span></code></h1><p>Ultrasonic sensor. Convenience functions to interact with the ultrasonic sensor through the I2C protocol.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-t" class="anchored"><a href="#type-t" class="anchor"></a><code><span><span class="keyword">type</span> <span>'a t</span></span></code></div><div class="spec-doc"><p>Represent an initialized ultrasonic sensor connected to a given port.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-make" class="anchored"><a href="#val-make" class="anchor"></a><code><span><span class="keyword">val</span> make : <span><span><span class="type-var">'a</span> <a href="../../index.html#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="../index.html#type-port">port</a> <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>make conn port</code> initialize the sensor on port <code>port</code> as being an ultrasonic one.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-set" class="anchored"><a href="#val-set" class="anchor"></a><code><span><span class="keyword">val</span> set : <span>?check_status:bool <span class="arrow">&#45;&gt;</span></span>
<span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Off <span>| `Meas</span> <span>| `Meas_cont</span> <span>| `Event</span> <span>| `Reset</span> <span><span>| `Meas_interval</span> of int</span> <span><span>| `Zero</span> of int</span> <span><span>| `Scale_mul</span> of int</span> <span><span>| `Scale_div</span> of int</span> ]</span> <span class="arrow">&#45;&gt;</span></span> <span>unit <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>Ultrasonic.set us cmd</code> set the state or parameters for the ultrasonic sensor <code>us</code>. <code>cmd</code> may be:</p><ul><li><code>`Off</code>: turns the ultrasonic sensor off.</li><li><code>`Meas</code>: single shot command. In this mode, the ultrasonic sensor will only make a new measurement every time the command byte is send to the sensor. The sensor will measure distances for up to 8 objects and save the distances within the <code>`Byte0</code> .. <code>`Byte7</code> variables.</li><li><code>`Meas_cont</code> Continuous measurement command. This is the default mode, where the sensor continuously makes new measurement with the specified interval (see <code>`Meas_interval</code> below).</li><li><code>`Event</code>: Event capture command. Within this mode the sensor will measure whether any other ultrasonic sensors are within the vicinity. With this information a program can evaluate when it is best to make a new measurement which will not conflict with other ultrasonic sensors.</li></ul><ul><li><code>`Meas_interval t</code>: set continuous measurment interval.</li><li><code>`Zero z</code>: set the actual zero.</li><li><code>`Scale_mul m</code>: set the actual scale factor.</li><li><code>`Scale_div d</code>: set the actual scale divisor.</li></ul><ul><li><code>`Reset</code>: resets the ultrasonic sensor.</li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">check_status</span> <p>check the return status. Exceptionally, the default is <code>true</code> because the sensor needs to time to set itself up anyway and this avoids <code>Mindstorm_lwt.NXT.Buffer_full</code> errors if we try to get values from the sensor.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-get" class="anchored"><a href="#val-get" class="anchor"></a><code><span><span class="keyword">val</span> get : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Byte0 <span>| `Byte1</span> <span>| `Byte2</span> <span>| `Byte3</span> <span>| `Byte4</span> <span>| `Byte5</span> <span>| `Byte6</span> <span>| `Byte7</span> <span>| `Meas_interval</span> <span>| `Zero</span> <span>| `Scale_mul</span> <span>| `Scale_div</span> ]</span> <span class="arrow">&#45;&gt;</span></span> <span>int <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>Ultrasonic.get us var</code> returns the content of the variable <code>var</code> on the sensor (detailed underneath). All values are between 0 and 255. Communication errors will be reported by raising <code>Error Bus_error</code>; your application should be ready to handle such exceptions.</p><ul><li><code>`Byte0</code> .. <code>`Byte7</code> are the 8 variables containing the distances measured with the <code>`Meas</code> or <code>`Meas_cont</code> command (in centimeters).</li></ul><ul><li><code>`Meas_interval</code> returns the interval (in 0.01 sec) between two consecutive measurments when the sensor is in continuous measurment (command <code>`Meas_cont</code>).</li></ul><ul><li><code>`Zero</code> returns the value of the actual zero (settable with the <code>`Zero</code> command).</li></ul><ul><li><code>`Scale_mul</code> (resp. <code>`Scale_div</code>) return the current scaling factor (resp. divisor). It is settable with the <code>`Scale_mul</code> (resp. <code>`Scale_div</code>) command.</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-get_state" class="anchored"><a href="#val-get_state" class="anchor"></a><code><span><span class="keyword">val</span> get_state : <span><span><span class="type-var">'a</span> <a href="#type-t">t</a></span> <span class="arrow">&#45;&gt;</span></span> <span><span>[ `Off <span>| `Meas</span> <span>| `Meas_cont</span> <span>| `Event</span> <span>| `Reset</span> ]</span> <span class="xref-unresolved">Lwt</span>.t</span></span></code></div><div class="spec-doc"><p><code>get_state us</code> get the current state of the ultrasonic sensor <code>us</code>.</p></div></div></div></body></html>