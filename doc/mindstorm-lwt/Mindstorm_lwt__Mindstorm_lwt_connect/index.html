<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Mindstorm_lwt__Mindstorm_lwt_connect (mindstorm-lwt.Mindstorm_lwt__Mindstorm_lwt_connect)</title><link rel="stylesheet" href="../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body><div class="content"><header><nav><a href="../index.html">Up</a> – <a href="../index.html">mindstorm-lwt</a> &#x00BB; Mindstorm_lwt__Mindstorm_lwt_connect</nav><h1>Module <code>Mindstorm_lwt__Mindstorm_lwt_connect</code></h1><p>Connection to bluetooth and USB devices, Lwt version.</p></header><aside><p>Connection to bluetooth and USB devices.</p></aside><dl><dt class="spec type" id="type-usb"><a href="#type-usb" class="anchor"></a><code><span class="keyword">type</span> usb</code></dt><dt class="spec type" id="type-bluetooth"><a href="#type-bluetooth" class="anchor"></a><code><span class="keyword">type</span> bluetooth</code></dt><dt class="spec type" id="type-t"><a href="#type-t" class="anchor"></a><code><span class="keyword">type</span> 'a t</code></dt><dd><p>Mutable bidirectional connection handle.</p></dd></dl><dl><dt class="spec value" id="val-connect_bluetooth"><a href="#val-connect_bluetooth" class="anchor"></a><code><span class="keyword">val</span> connect_bluetooth : check_status:bool <span>&#45;&gt;</span> check_status_fn:(Bytes.t <span>&#45;&gt;</span> unit Lwt.t) <span>&#45;&gt;</span> string <span>&#45;&gt;</span> <a href="index.html#type-bluetooth">bluetooth</a> <a href="index.html#type-t">t</a> Lwt.t</code></dt></dl><dl><dt class="spec module" id="module-USB"><a href="#module-USB" class="anchor"></a><code><span class="keyword">module</span> <a href="USB/index.html">USB</a> : <span class="keyword">sig</span> ... <span class="keyword">end</span></code></dt><dd><p>Connection to USB devices. See <a href="../../mindstorm/Mindstorm__/Mindstorm__NXT/USB/index.html"><code>Mindstorm.NXT.USB</code></a> and <span class="xref-unresolved" title="unresolved reference to &quot;Mindstorm.NXT.USB_lwt&quot;"><a href="../../mindstorm/Mindstorm/index.html#module-NXT"><code>Mindstorm.NXT</code></a>.USB_lwt</span> for more information.</p></dd></dl><dl><dt class="spec value" id="val-send"><a href="#val-send" class="anchor"></a><code><span class="keyword">val</span> send : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bytes.t <span>&#45;&gt;</span> unit Lwt.t</code></dt><dd><p><code>send conn s</code> send &quot;package&quot; <code>s</code> on the connection <code>c</code>. <code>s</code> is supposed to come prefixed with 2 bytes indicating its length (since this is necessary for bluetooth) — they will be stripped for USB.</p></dd></dl><dl><dt class="spec value" id="val-recv"><a href="#val-recv" class="anchor"></a><code><span class="keyword">val</span> recv : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> int <span>&#45;&gt;</span> Bytes.t Lwt.t</code></dt><dd><p><code>recv conn n</code> reads a &quot;package&quot; of length <code>n</code> and return it. For bluetooth, the prefix of 2 bytes indicating the length are also read but not returned (and not counted in <code>n</code>). <code>recv</code> checks the status byte using <code>check_status_fn</code> and possibly raise an exception (it is the task of <code>check_status_fn</code> to do that), regardless of the value of <code>check_status</code> (this is to allow to override <code>check_status</code> locally).</p></dd></dl><dl><dt class="spec value" id="val-really_input"><a href="#val-really_input" class="anchor"></a><code><span class="keyword">val</span> really_input : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> Bytes.t <span>&#45;&gt;</span> int <span>&#45;&gt;</span> int <span>&#45;&gt;</span> unit Lwt.t</code></dt><dd><p><code>really_input conn buf ofs len</code> reads <code>len</code> characters from <code>conn</code> and puts them in <code>buf</code> starting at position <code>ofs</code>. It does NOT read the bluetooth prefix bytes, so should not be used for packages but only for additional data.</p></dd></dl><dl><dt class="spec value" id="val-close"><a href="#val-close" class="anchor"></a><code><span class="keyword">val</span> close : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit Lwt.t</code></dt><dd><p>Close the connection.</p></dd></dl><dl><dt class="spec value" id="val-want_check_status_by_default"><a href="#val-want_check_status_by_default" class="anchor"></a><code><span class="keyword">val</span> want_check_status_by_default : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> bool</code></dt><dd><p>Says whether <code>~check_status:true</code> was passed to the connection function.</p></dd></dl><dl><dt class="spec value" id="val-lock"><a href="#val-lock" class="anchor"></a><code><span class="keyword">val</span> lock : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit Lwt.t</code></dt><dd><p>With Lwt, connections come with a Lwt mutex that may be used to ensure that a sequence of send + recv is atomic.</p></dd></dl><dl><dt class="spec value" id="val-unlock"><a href="#val-unlock" class="anchor"></a><code><span class="keyword">val</span> unlock : <span class="type-var">'a</span> <a href="index.html#type-t">t</a> <span>&#45;&gt;</span> unit</code></dt></dl></div></body></html>