<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Motor (mindstorm.Mindstorm.NXT.Motor)</title><link rel="stylesheet" href="../../../../odoc.css"/><meta charset="utf-8"/><meta name="generator" content="odoc 2.0.0"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><script src="../../../../highlight.pack.js"></script><script>hljs.initHighlightingOnLoad();</script></head><body class="odoc"><nav class="odoc-nav"><a href="../index.html">Up</a> â€“ <a href="../../../index.html">mindstorm</a> &#x00BB; <a href="../../index.html">Mindstorm</a> &#x00BB; <a href="../index.html">NXT</a> &#x00BB; Motor</nav><header class="odoc-preamble"><h1>Module <code><span>NXT.Motor</span></code></h1><p>Output ports.</p></header><div class="odoc-content"><div class="odoc-spec"><div class="spec type" id="type-port" class="anchored"><a href="#type-port" class="anchor"></a><code><span><span class="keyword">type</span> port</span></code></div><div class="spec-doc"><p>The three motor ports (immutable). For more readability of your program, it is recommended you give appropriate aliases to the ports of interest at the beginning of your program, e.g. <code>let motor_right = Mindstorm.NXT.Motor.a</code>.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-a" class="anchored"><a href="#val-a" class="anchor"></a><code><span><span class="keyword">val</span> a : <a href="#type-port">port</a></span></code></div><div class="spec-doc"><p>The motor port A.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-b" class="anchored"><a href="#val-b" class="anchor"></a><code><span><span class="keyword">val</span> b : <a href="#type-port">port</a></span></code></div><div class="spec-doc"><p>The motor port B.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-c" class="anchored"><a href="#val-c" class="anchor"></a><code><span><span class="keyword">val</span> c : <a href="#type-port">port</a></span></code></div><div class="spec-doc"><p>The motor port C.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-all" class="anchored"><a href="#val-all" class="anchor"></a><code><span><span class="keyword">val</span> all : <a href="#type-port">port</a></span></code></div><div class="spec-doc"><p>Special value representing all 3 ports.</p></div></div><div class="odoc-spec"><div class="spec type" id="type-regulation" class="anchored"><a href="#type-regulation" class="anchor"></a><code><span><span class="keyword">type</span> regulation</span><span> = </span><span>[ </span></code><table><tr id="type-regulation.Idle" class="anchored"><td class="def constructor"><a href="#type-regulation.Idle" class="anchor"></a><code><span>| </span></code><code><span>`Idle</span></code></td></tr><tr id="type-regulation.Motor_speed" class="anchored"><td class="def constructor"><a href="#type-regulation.Motor_speed" class="anchor"></a><code><span>| </span></code><code><span>`Motor_speed</span></code></td></tr><tr id="type-regulation.Motor_sync" class="anchored"><td class="def constructor"><a href="#type-regulation.Motor_sync" class="anchor"></a><code><span>| </span></code><code><span>`Motor_sync</span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>Regulation mode.</p><ul><li><code>`Idle</code>: No regulation will be enabled.</li><li><code>`Motor_speed</code>: enable power control: auto adjust PWM duty cycle if motor is affected by physical load.</li><li><code>`Motor_sync</code>: enable synchronization: attempt to keep rotation in sync with another motor. You typically use this mode is to maintain a straight path for a vehicle robot automatically. You also can use this mode with the <a href="#type-state"><code>Mindstorm.NXT.Motor.state</code></a> <code>turn_ratio</code> property to provide proportional turning. You must set <code>`Motor_sync</code> on at least two motor ports to have the desired affect. If it is set on all three motor ports, only the first two (A and B) are synchronized. .</li></ul></div></div><div class="odoc-spec"><div class="spec type" id="type-run_state" class="anchored"><a href="#type-run_state" class="anchor"></a><code><span><span class="keyword">type</span> run_state</span><span> = </span><span>[ </span></code><table><tr id="type-run_state.Idle" class="anchored"><td class="def constructor"><a href="#type-run_state.Idle" class="anchor"></a><code><span>| </span></code><code><span>`Idle</span></code></td></tr><tr id="type-run_state.Ramp_up" class="anchored"><td class="def constructor"><a href="#type-run_state.Ramp_up" class="anchor"></a><code><span>| </span></code><code><span>`Ramp_up</span></code></td></tr><tr id="type-run_state.Running" class="anchored"><td class="def constructor"><a href="#type-run_state.Running" class="anchor"></a><code><span>| </span></code><code><span>`Running</span></code></td></tr><tr id="type-run_state.Ramp_down" class="anchored"><td class="def constructor"><a href="#type-run_state.Ramp_down" class="anchor"></a><code><span>| </span></code><code><span>`Ramp_down</span></code></td></tr></table><code><span> ]</span></code></div><div class="spec-doc"><p>Specifies how to perform the transition to the new <code>speed</code> given in <a href="#type-state"><code>Mindstorm.NXT.Motor.state</code></a>.</p><ul><li><code>`Idle</code>: The motor is not run.</li><li><code>`Running</code> enables power to any output device connected to the specified port(s).</li><li><code>`Ramp_up</code> enables automatic ramping to a new speed set-point that is greater than the current speed set-point. When you use <code>`Ramp_up</code> in conjunction with appropriate <code>tach_limit</code> and <code>speed</code> values, the NXT firmware attempts to increase the actual power smoothly to the <code>speed</code> set-point over the number of degrees specified by <code>tach_limit</code>.</li><li><code>`Ramp_down</code> enables automatic ramping to a new speed set-point that is less than the current speed set-point. When you use <code>`Ramp_down</code> in conjunction with appropriate <code>tach_limit</code> and <code>speed</code> values, the NXT firmware attempts to smoothly decrease the actual power to the <code>speed</code> set-point over the number of degrees specified by <code>tach_limit</code>.</li></ul></div></div><div class="odoc-spec"><div class="spec type" id="type-state" class="anchored"><a href="#type-state" class="anchor"></a><code><span><span class="keyword">type</span> state</span><span> = </span><span>{</span></code><table><tr id="type-state.speed" class="anchored"><td class="def record field"><a href="#type-state.speed" class="anchor"></a><code><span>speed : int;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Power set-point. Range: -100 .. 100. Values larger than 100 will be taken as 100 and values less than -100 will be takes as -100.</p><span class="comment-delim">*)</span></td></tr><tr id="type-state.motor_on" class="anchored"><td class="def record field"><a href="#type-state.motor_on" class="anchor"></a><code><span>motor_on : bool;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>if <code>true</code>, turns the motor on: enables pulse-width modulation (PWM) power according to speed.</p><span class="comment-delim">*)</span></td></tr><tr id="type-state.brake" class="anchored"><td class="def record field"><a href="#type-state.brake" class="anchor"></a><code><span>brake : bool;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Use run/brake instead of run/float. &quot;Braking&quot; in this sense means that the output voltage is not allowed to float between active PWM pulses. Electronic braking improves the accuracy (and is necessary to see a rotation at small speeds) of motor output, but uses slightly more battery power.</p><span class="comment-delim">*)</span></td></tr><tr id="type-state.regulation" class="anchored"><td class="def record field"><a href="#type-state.regulation" class="anchor"></a><code><span>regulation : <a href="#type-regulation">regulation</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Turns on the chosen regulation.</p><span class="comment-delim">*)</span></td></tr><tr id="type-state.turn_ratio" class="anchored"><td class="def record field"><a href="#type-state.turn_ratio" class="anchor"></a><code><span>turn_ratio : int;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Range: -100 .. 100. See <a href="#type-regulation"><code>Mindstorm.NXT.Motor.regulation</code></a>.</p><span class="comment-delim">*)</span></td></tr><tr id="type-state.run_state" class="anchored"><td class="def record field"><a href="#type-state.run_state" class="anchor"></a><code><span>run_state : <a href="#type-run_state">run_state</a>;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>See <a href="#type-run_state"><code>Mindstorm.NXT.Motor.run_state</code></a>.</p><span class="comment-delim">*)</span></td></tr><tr id="type-state.tach_limit" class="anchored"><td class="def record field"><a href="#type-state.tach_limit" class="anchor"></a><code><span>tach_limit : int;</span></code></td><td class="def-doc"><span class="comment-delim">(*</span><p>Number of degrees to rotate; <code>0</code>: run forever. Range: 0 .. 4294967295 (unsigned 32 bits). See also <a href="#type-run_state"><code>Mindstorm.NXT.Motor.run_state</code></a>.</p><span class="comment-delim">*)</span></td></tr></table><code><span>}</span></code></div><div class="spec-doc"><p>The absolute value of <code>speed</code> is used as a percentage of the full power capabilities of the motor. The sign of <code>speed</code> specifies rotation direction. You must set some other properties appropriately for the <code>speed</code> set-point to have the desired effect:</p><ul><li><code>motor_on</code> must be <code>true</code>.</li><li><code>run_state</code> must be set to a non-<code>`Idle</code> value.</li></ul><p>If <code>not motor_on &amp;&amp; not brake</code>, motors are in COAST mode: motors connected to the specified port(s) will rotate freely.</p></div></div><div class="odoc-spec"><div class="spec value" id="val-speed" class="anchored"><a href="#val-speed" class="anchor"></a><code><span><span class="keyword">val</span> speed : <span>?tach_limit:int <span class="arrow">&#45;&gt;</span></span> <span>?brake:bool <span class="arrow">&#45;&gt;</span></span> <span>?sync:bool <span class="arrow">&#45;&gt;</span></span> <span>?turn_ratio:int <span class="arrow">&#45;&gt;</span></span> <span>int <span class="arrow">&#45;&gt;</span></span> <a href="#type-state">state</a></span></code></div><div class="spec-doc"><p><code>speed s</code> returns a state where <code>speed</code> is <code>s</code>, <code>motor_on</code> is <code>true</code> if and only if <code>s &lt;&gt; 0</code>, and <code>run_state = `Running</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">tach_limit</span> <p>set the number of degrees to rotate. The movement is unfortunately not fully accurate. Default: <code>0</code> which means &quot;no limit&quot;.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">brake</span> <p>turns on brake. Default: <code>true</code>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">sync</span> <p>turn on <code>`Motor_sync</code>. Default: <code>false</code>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">turn_ratio</span> <p>set a turn-ratio. Default: <code>0</code>.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-set" class="anchored"><a href="#val-set" class="anchor"></a><code><span><span class="keyword">val</span> set : <span>?check_status:bool <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../index.html#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-port">port</a> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-state">state</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>set conn p st</code> sets the state of the motor connected to the port <code>p</code> to <code>st</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">check_status</span> <p>whether to check the status returned by the brick. Default: see <code>Mindstorm</code>.NXT.connect_bluetooth.</p></li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-get" class="anchored"><a href="#val-get" class="anchor"></a><code><span><span class="keyword">val</span> get : <span><span><span class="type-var">'a</span> <a href="../index.html#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-port">port</a> <span class="arrow">&#45;&gt;</span></span> <a href="#type-state">state</a> * int * int * int</span></code></div><div class="spec-doc"><p><code>get conn p</code> returns <code>(state, tach_count, block_tach_count,
        rotation_count)</code> where</p><ul><li><code>state</code> is the current state of the motors;</li><li><code>tach_count</code> is the number of counts since the last reset of the motor counter (the reset occurs when <a href="#val-set"><code>Mindstorm.NXT.Motor.set</code></a> is issued);</li><li><code>block_tach_count</code> is the current position relative to the last programmed movement.</li><li><code>rotation_count</code> is the program-relative position counter relative to the last reset of the rotation sensor for motorÂ <code>p</code>.</li></ul></div></div><div class="odoc-spec"><div class="spec value" id="val-reset_pos" class="anchored"><a href="#val-reset_pos" class="anchor"></a><code><span><span class="keyword">val</span> reset_pos : <span>?check_status:bool <span class="arrow">&#45;&gt;</span></span> <span><span><span class="type-var">'a</span> <a href="../index.html#type-conn">conn</a></span> <span class="arrow">&#45;&gt;</span></span> <span>?relative:bool <span class="arrow">&#45;&gt;</span></span> <span><a href="#type-port">port</a> <span class="arrow">&#45;&gt;</span></span> unit</span></code></div><div class="spec-doc"><p><code>reset_pos conn p</code> resets the rotation count (given by the <code>rotation_count</code> field of <a href="#val-get"><code>Mindstorm.NXT.Motor.get</code></a>) of the motor connected to port <code>p</code>.</p><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">relative</span> <p>if <code>true</code>, relative to the last movement, otherwise absolute position. Default: <code>false</code>.</p></li></ul><ul class="at-tags"><li class="parameter"><span class="at-tag">parameter</span> <span class="value">check_status</span> <p>whether to check the status returned by the brick. Default: see <code>Mindstorm</code>.NXT.connect_bluetooth.</p></li></ul></div></div></div></body></html>